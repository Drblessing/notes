# Fail2ban Configuration
# File: /etc/fail2ban/jail.local

[DEFAULT]
# Ban time in seconds (1 hour)
bantime = 3600

# Find time window in seconds (10 minutes)
findtime = 600

# Number of failures before ban
maxretry = 3

# Backend for log parsing
backend = auto

# Email notifications (configure as needed)
# destemail = admin@example.com
# sender = fail2ban@example.com
# action = %(action_mwl)s

[sshd]
enabled = true
port = ssh
filter = sshd
logpath = /var/log/auth.log
maxretry = 3
bantime = 3600

[nginx-http-auth]
enabled = false
port = http,https
filter = nginx-http-auth
logpath = /var/log/nginx/error.log
maxretry = 3

[nginx-limit-req]
enabled = false
port = http,https
filter = nginx-limit-req
logpath = /var/log/nginx/error.log
maxretry = 3

[apache-auth]
enabled = false
port = http,https
filter = apache-auth
logpath = /var/log/apache2/error.log
maxretry = 3

[apache-badbots]
enabled = false
port = http,https
filter = apache-badbots
logpath = /var/log/apache2/access.log
bantime = 86400
maxretry = 1

[php-url-fopen]
enabled = false
port = http,https
filter = php-url-fopen
logpath = /var/log/nginx/access.log

# Custom jails (add as needed)
[custom-iptables]
enabled = false
filter = custom
action = iptables[name=CUSTOM, port=80, protocol=tcp]
logpath = /var/log/custom.log
maxretry = 2
